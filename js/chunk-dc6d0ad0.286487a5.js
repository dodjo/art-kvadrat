(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dc6d0ad0"],{"0a59":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.load,expression:"load"}],staticClass:"page"},[n("div",{staticClass:"page__content"},[n("div",{staticClass:"page__header"},[n("breadcrumbs"),n("h1",{staticClass:"page__title"},[t._v("\n        "+t._s(t.event.title)+"\n      ")])],1),n("div",{staticClass:"event"},[n("div",{staticClass:"event__header"},[n("div",{staticClass:"event__block-first"},[t.getCategory?n("div",{staticClass:"event__genre"},[t._v(t._s(t.getCategory))]):t._e(),t.getPlace?n("div",{staticClass:"event__location"},[t._v(t._s(t.getPlace))]):t._e(),t.getDate?n("div",{staticClass:"event__date"},[t._v(t._s(t.getDate))]):t._e()]),n("div",{staticClass:"event__block-second"},[t.event.is_favorite?n("div",{staticClass:"event__bookmark",on:{click:t.onDeleteFavorite}},[n("svg",{attrs:{width:"20",height:"20"}},[n("use",{attrs:{href:a("4882")+"#icon-bookmark"}})]),t._v("\n            В избранном\n          ")]):t._e(),t.event.is_favorite?t._e():n("div",{staticClass:"event__bookmark",on:{click:t.onCreateFavorite}},[n("svg",{attrs:{width:"20",height:"20"}},[n("use",{attrs:{href:a("4882")+"#icon-bookmark-border"}})]),t._v("\n            В избранном\n          ")]),n("div",{staticClass:"event__free"},[t._v("Бесплатно")])])])]),n("div",{staticClass:"event__body"},[t.event.title_picture.url?n("div",{staticClass:"event__image"},[n("img",{attrs:{src:t.event.title_picture.url,alt:""}})]):t._e(),n("div",{staticClass:"event__description"},[n("div",{staticClass:"event__col-left"},[n("h2",{staticClass:"event__title"},[t._v("О событии")]),n("div",{domProps:{innerHTML:t._s(t.event.body)}})]),n("div",{staticClass:"event__col-right"},[n("h2",{staticClass:"event__title"},[t._v("\n            Рейтинг\n          ")]),n("div",{staticClass:"event__rating"},[n("star-rating",{attrs:{"read-only":!0,"star-size":28,rating:t.event.rating}}),n("div",{staticClass:"event__voting"},[t._v("\n              "+t._s(t.getVoteCount)+"\n            ")])],1)])]),t.event.images.length?n("image-gallery",{attrs:{images:t.event.images}}):t._e()],1),n("comments",{attrs:{comments:t.event.comments},on:{"add-comment":t.addNewComment}})],1)])},r=[],s=(a("96cf"),a("1da1")),i=a("686a"),o=a("62a9"),c=a("5b3d"),l=a.n(c),u=a("bc3a"),v=a.n(u),d=a("e09c"),m=a("4328"),_=a.n(m),f={name:"EventPage",components:{Comments:o["a"],ImageGallery:i["a"],StarRating:l.a},mixins:[d["a"]],data:function(){return{event:{place:{title:""},title_picture:{url:""},images:[]},comments:[],load:!1}},mounted:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.loadData();case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{loadData:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$loading.show(),a=new URL("".concat("http://api.art-kvadrat.localhost","/v1/event/view")),a.searchParams.set("id",this.$route.params.id),t.next=5,v.a.get(a).then((function(t){n.event=t.data,n.load=!0,e.hide()})).catch((function(t){404===t.response.status?(n.$toasted.global.error("Событие не найдено"),n.$router.push("/playbill")):n.$toasted.global.error(t.response.data.message),t.response||(n.$toasted.global.error("Нет соединения с сервером"),e.hide()),e.hide()}));case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),addNewComment:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:v.a.post("".concat("http://api.art-kvadrat.localhost","/v1/event-comment/create"),_.a.stringify({event_id:this.event.id,body:e.body})).then((function(t){a.event.comments.push(t.data)})).catch((function(t){console.log(t.request)}));case 1:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),onCreateFavorite:function(){var t=this,e=_.a.stringify({entity_type:"event",entity_id:this.event.id});v.a.post("".concat("http://api.art-kvadrat.localhost","/v1/favorite/create"),e).then((function(e){t.event.is_favorite=e.data.id})).catch((function(e){e.response||t.$toasted.global.error("Нет соединения с сервером"),console.log(e)}))},onDeleteFavorite:function(){var t=this,e=new URL("".concat("http://api.art-kvadrat.localhost","/v1/favorite/delete"));e.searchParams.append("id",this.event.is_favorite),v.a.delete(e).then((function(){t.event.is_favorite=0})).catch((function(e){e.response||t.$toasted.global.error("Нет соединения с сервером"),console.log(e)}))}},computed:{getCategory:function(){return this.event.categories?this.event.categories.map((function(t){return t.title})).join(" ● "):""},getPlace:function(){return this.event.place&&this.event.place.title},getDate:function(){return this.event.begin_time?this.$options.filters.formatDate(this.event.begin_time):""},getVoteCount:function(){return this.event.vote_count+" "+this.getNoun(this.event.vote_count,"голос","голоса","голосов")}}},p=f,h=a("2877"),g=Object(h["a"])(p,n,r,!1,null,"d6805c52",null);e["default"]=g.exports},"5dbc":function(t,e,a){var n=a("d3f4"),r=a("8b97").set;t.exports=function(t,e,a){var s,i=e.constructor;return i!==a&&"function"==typeof i&&(s=i.prototype)!==a.prototype&&n(s)&&r&&r(t,s),t}},"62a9":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"reviews"},[a("div",{staticClass:"reviews__header"},[a("h2",{staticClass:"reviews__title"},[t._v("Отзывы и оценки")]),t.isAuthenticated?a("a",{staticClass:"reviews__btn button-secondary",on:{click:t.gotoNewComment}},[t._v("комментировать")]):t._e()]),t._l(t.comments,(function(e,n){return a("div",{key:n,staticClass:"reviews__list"},[a("div",{staticClass:"reviews__img"},[a("img",{attrs:{src:e.author.avatar.url,alt:""}})]),a("div",{staticClass:"reviews__wrap"},[a("div",{staticClass:"reviews__name"},[t._v(t._s(e.author.full_name))]),a("div",{staticClass:"reviews__date"},[t._v(t._s(t._f("formatDate")(e.created_at)))]),a("div",{staticClass:"reviews__comment"},[t._v(t._s(e.body))])])])})),t.isAuthenticated?a("div",{ref:"new-comment",staticClass:"reviews__list"},[a("div",{staticClass:"reviews__img"},[a("img",{attrs:{src:t.currentUser.avatar.url,alt:""}})]),a("div",{staticClass:"reviews__wrap"},[a("div",{staticClass:"reviews__name"},[t._v(t._s(t.currentUser.full_name))]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newComment.body,expression:"newComment.body"}],staticClass:"reviews__input",attrs:{placeholder:"Написать отзыв"},domProps:{value:t.newComment.body},on:{input:function(e){e.target.composing||t.$set(t.newComment,"body",e.target.value)}}}),a("button",{staticClass:"reviews__btn-comment button-primary",on:{click:t.addComment}},[t._v("\n        комментировать\n      ")])])]):t._e()],2)},r=[],s=(a("8e6e"),a("ac6a"),a("456d"),a("ade3")),i=a("e09c"),o=a("2f62");function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(Object(a),!0).forEach((function(e){Object(s["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var u={name:"Comments",props:{comments:{type:Array,default:function(){return[]}}},data:function(){return{newComment:{body:""},currentUser:{avatar:{url:""},full_name:""}}},mixins:[i["a"]],methods:{addComment:function(){this.$emit("add-comment",this.newComment),this.newComment.body=""},gotoNewComment:function(){window.scroll({top:this.$refs["new-comment"].offsetTop,behavior:"smooth"})}},mounted:function(){this.currentUser=this.$store.getters["user/getUser"]},computed:l({},Object(o["c"])("auth",["isAuthenticated"]))},v=u,d=a("2877"),m=Object(d["a"])(v,n,r,!1,null,"bf8dc9e6",null);e["a"]=m.exports},"686a":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"image-gallery"},t._l(t.images,(function(e,n){return a("div",{directives:[{name:"show",rawName:"v-show",value:n<t.showImages,expression:"index < showImages"}],key:n,staticClass:"image-gallery__item"},[a("img",{directives:[{name:"img",rawName:"v-img:group",arg:"group"}],attrs:{src:e.url}}),n==t.showImages-1&&t.countHideImages>0?a("div",{staticClass:"image-gallery__count"},[t._v("\n      +"+t._s(t.countHideImages)+"\n    ")]):t._e()])})),0)},r=[],s=(a("c5f6"),{name:"ImageGallery",props:{images:{type:Array,default:function(){return[]}},showImages:{type:Number,default:4}},data:function(){return{imagesArray:[]}},computed:{countHideImages:function(){return this.images.length-this.showImages}},mounted:function(){this.imagesArray=this.images.slice(0,this.showImages)}}),i=s,o=a("2877"),c=Object(o["a"])(i,n,r,!1,null,"25b161fa",null);e["a"]=c.exports},"8b97":function(t,e,a){var n=a("d3f4"),r=a("cb7c"),s=function(t,e){if(r(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{n=a("9b43")(Function.call,a("11e9").f(Object.prototype,"__proto__").set,2),n(t,[]),e=!(t instanceof Array)}catch(r){e=!0}return function(t,a){return s(t,a),e?t.__proto__=a:n(t,a),t}}({},!1):void 0),check:s}},aa77:function(t,e,a){var n=a("5ca1"),r=a("be13"),s=a("79e5"),i=a("fdef"),o="["+i+"]",c="​",l=RegExp("^"+o+o+"*"),u=RegExp(o+o+"*$"),v=function(t,e,a){var r={},o=s((function(){return!!i[t]()||c[t]()!=c})),l=r[t]=o?e(d):i[t];a&&(r[a]=l),n(n.P+n.F*o,"String",r)},d=v.trim=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(u,"")),t};t.exports=v},c5f6:function(t,e,a){"use strict";var n=a("7726"),r=a("69a8"),s=a("2d95"),i=a("5dbc"),o=a("6a99"),c=a("79e5"),l=a("9093").f,u=a("11e9").f,v=a("86cc").f,d=a("aa77").trim,m="Number",_=n[m],f=_,p=_.prototype,h=s(a("2aeb")(p))==m,g="trim"in String.prototype,b=function(t){var e=o(t,!1);if("string"==typeof e&&e.length>2){e=g?e.trim():d(e,3);var a,n,r,s=e.charCodeAt(0);if(43===s||45===s){if(a=e.charCodeAt(2),88===a||120===a)return NaN}else if(48===s){switch(e.charCodeAt(1)){case 66:case 98:n=2,r=49;break;case 79:case 111:n=8,r=55;break;default:return+e}for(var i,c=e.slice(2),l=0,u=c.length;l<u;l++)if(i=c.charCodeAt(l),i<48||i>r)return NaN;return parseInt(c,n)}}return+e};if(!_(" 0o1")||!_("0b1")||_("+0x1")){_=function(t){var e=arguments.length<1?0:t,a=this;return a instanceof _&&(h?c((function(){p.valueOf.call(a)})):s(a)!=m)?i(new f(b(e)),a,_):b(e)};for(var w,C=a("9e1e")?l(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),y=0;C.length>y;y++)r(f,w=C[y])&&!r(_,w)&&v(_,w,u(f,w));_.prototype=p,p.constructor=_,a("2aba")(n,m,_)}},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-dc6d0ad0.286487a5.js.map