{"version":3,"sources":["webpack:///./src/pages/UpdateStartup.vue?4c3b","webpack:///src/pages/UpdateStartup.vue","webpack:///./src/pages/UpdateStartup.vue?312e","webpack:///./src/pages/UpdateStartup.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_m","attrs","$v","form","title","$error","model","value","callback","$$v","$set","expression","CATEGORY","categories","on","$event","class","body","customToolbar","directives","name","rawName","_v","ref","handleFilePond","updateStartup","staticRenderFns","components","VInput","VMultiselect","VueEditor","FilePond","data","load","title_picture","images","category","validations","required","mounted","GET_CATEGORY","viewStartup","methods","fileImages","map","computed","component"],"mappings":"uHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,MAAM,CAACE,YAAY,iBAAiB,CAACN,EAAIO,GAAG,GAAGH,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACF,EAAG,MAAM,CAACE,YAAY,wBAAwB,CAACF,EAAG,UAAU,CAACI,MAAM,CAAC,MAAQ,YAAY,MAAQR,EAAIS,GAAGC,KAAKC,MAAMC,OAAO,aAAa,oBAAoB,gBAAgB,IAAIC,MAAM,CAACC,MAAOd,EAAIS,GAAGC,KAAKC,MAAY,OAAEI,SAAS,SAAUC,GAAMhB,EAAIiB,KAAKjB,EAAIS,GAAGC,KAAKC,MAAO,SAAUK,IAAME,WAAW,0BAA0Bd,EAAG,gBAAgB,CAACI,MAAM,CAAC,MAAQ,YAAY,QAAUR,EAAImB,SAAS,MAAQnB,EAAIU,KAAKU,YAAYC,GAAG,CAAC,eAAe,SAASC,GAAQtB,EAAIU,KAAKU,WAAaE,MAAWlB,EAAG,MAAM,CAACE,YAAY,eAAeiB,MAAM,CAAE,sBAAuBvB,EAAIS,GAAGC,KAAKc,KAAKZ,SAAU,CAACR,EAAG,aAAa,CAACI,MAAM,CAAC,cAAgBR,EAAIyB,eAAeZ,MAAM,CAACC,MAAOd,EAAIS,GAAGC,KAAKc,KAAW,OAAET,SAAS,SAAUC,GAAMhB,EAAIiB,KAAKjB,EAAIS,GAAGC,KAAKc,KAAM,SAAUR,IAAME,WAAW,yBAAyBd,EAAG,QAAQ,CAACsB,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASd,OAAQd,EAAIS,GAAGC,KAAKc,KAAKZ,OAAQM,WAAW,0BAA0B,CAAClB,EAAI6B,GAAG,wCAAwCzB,EAAG,OAAO,CAACE,YAAY,yBAAyB,CAACN,EAAI6B,GAAG,SAASzB,EAAG,QAAQ,CAACsB,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASd,MAAOd,EAAIS,GAAGC,KAAKc,KAAW,OAAEN,WAAW,yBAAyB,CAAClB,EAAI6B,GAAG,uBAAuB,GAAGzB,EAAG,YAAY,CAAC0B,IAAI,OAAOtB,MAAM,CAAC,KAAO,OAAO,aAAa,gBAAgB,kBAAiB,EAAK,sBAAsB,wBAAwB,mBAAqB,MAAM,iBAAgB,EAAK,YAAY,GAAGa,GAAG,CAAC,YAAcrB,EAAI+B,eAAe,aAAe/B,EAAI+B,kBAAkB3B,EAAG,MAAM,CAACE,YAAY,kCAAkC,CAACF,EAAG,SAAS,CAACE,YAAY,iBAAiBe,GAAG,CAAC,MAAQrB,EAAIgC,gBAAgB,CAAChC,EAAI6B,GAAG,wDAAwD,UAC90DI,EAAkB,CAAC,WAAa,IAAIjC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,KAAK,CAACE,YAAY,eAAe,CAACN,EAAI6B,GAAG,qD,y0BCoF7L,UACA,IACA,KAGA,GACEF,KAAM,gBACNO,WAAY,CACVC,OAAJ,OACIC,aAAJ,OACIC,UAAJ,OACIC,SAAJ,GAEEC,KARF,WASI,MAAO,CACLC,MAAM,EACN9B,KAAM,CACJC,MAAO,GACPa,KAAM,GACNJ,WAAY,GACZqB,cAAe,GACfC,OAAQ,IAEVD,cAAe,KACfE,SAAU,GACVlB,cAAe,CACrB,8BACA,EAAQ,KAAR,YAAQ,KAAR,cAIEmB,YAAa,CACXlC,KAAM,CACJC,MAAO,CACLkC,SAAR,eAEMrB,KAAM,CACJqB,SAAR,iBAIEC,QApCF,WAqCI7C,KAAK8C,eACL9C,KAAK+C,eAEPC,QAAS,EAAX,KACA,6CADA,IAEIlB,eAAgB,WACd,IAAN,6BACM9B,KAAKwC,cAAgBS,EAAWC,KAAI,SAA1C,wBAEI,iBANJ,2KAOA,eACA,oCARA,SAUA,IACA,KADA,UAEA,mCAFA,0BAGA,EACA,CACA,SACA,wCAIA,kBACA,kCAEA,mBACA,kBAxBA,wGA2BI,YA3BJ,6KA4BA,uBAEA,4EACA,+CA/BA,SAiCA,IACA,OACA,kBACA,0BACA,wBACA,oCACA,UACA,YAEA,mBACA,yBACA,6CACA,6BAEA,iDAEA,aACA,qDACA,UAEA,YArDA,wGAwDI,cAxDJ,yKAyDA,iBACA,iBA1DA,qBA2DA,mBA3DA,gCA4DA,wBA5DA,cA+DA,iBACA,sBACA,oBACA,kEACA,wCAGA,8EACA,+CAvEA,UAyEA,IACA,WACA,kBACA,0BACA,4CAEA,0BACA,wBACA,oCACA,wBACA,iBACA,2BACA,cACA,mCAEA,mBACA,4BACA,yCA1FA,2GAgGEC,SAAU,EAAZ,GACA,0CCnOuV,I,YCOnVC,EAAY,eACd,EACAtD,EACAkC,GACA,EACA,KACA,WACA,MAIa,aAAAoB,E","file":"js/chunk-2d218039.fd9c5ebd.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page\"},[_c('div',{staticClass:\"page__content\"},[_vm._m(0),_c('div',{staticClass:\"create-startup\"},[_c('div',{staticClass:\"create-startup__form\"},[_c('v-input',{attrs:{\"label\":'Заголовок',\"error\":_vm.$v.form.title.$error,\"text-error\":'введите заголовок',\"require-input\":\"\"},model:{value:(_vm.$v.form.title.$model),callback:function ($$v) {_vm.$set(_vm.$v.form.title, \"$model\", $$v)},expression:\"$v.form.title.$model\"}}),_c('v-multiselect',{attrs:{\"label\":'Категория',\"options\":_vm.CATEGORY,\"value\":_vm.form.categories},on:{\"multi-change\":function($event){_vm.form.categories = $event}}}),_c('div',{staticClass:\"form-control\",class:{ 'form-control--error': _vm.$v.form.body.$error }},[_c('vue-editor',{attrs:{\"editorToolbar\":_vm.customToolbar},model:{value:(_vm.$v.form.body.$model),callback:function ($$v) {_vm.$set(_vm.$v.form.body, \"$model\", $$v)},expression:\"$v.form.body.$model\"}}),_c('label',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.$v.form.body.$error),expression:\"!$v.form.body.$error\"}]},[_vm._v(\"\\n            Описание\\n            \"),_c('span',{staticClass:\"form-control__require\"},[_vm._v(\"*\")])]),_c('label',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.$v.form.body.$error),expression:\"$v.form.body.$error\"}]},[_vm._v(\"введите описание\")])],1),_c('file-pond',{ref:\"pond\",attrs:{\"name\":\"test\",\"label-idle\":\"Добавить фото\",\"allow-multiple\":true,\"accepted-file-types\":\"image/jpeg, image/png\",\"imagePreviewHeight\":\"100\",\"allow-reorder\":true,\"max-files\":1},on:{\"updatefiles\":_vm.handleFilePond,\"reorderfiles\":_vm.handleFilePond}}),_c('div',{staticClass:\"create-startup__form-group-btn\"},[_c('button',{staticClass:\"button-primary\",on:{\"click\":_vm.updateStartup}},[_vm._v(\"\\n            Отправить на проверку\\n          \")])])],1)])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page__header\"},[_c('h1',{staticClass:\"page__title\"},[_vm._v(\"\\n        Редактировать арт-стартап\\n      \")])])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"page\">\r\n    <div class=\"page__content\">\r\n      <div class=\"page__header\">\r\n        <h1 class=\"page__title\">\r\n          Редактировать арт-стартап\r\n        </h1>\r\n      </div>\r\n\r\n      <div class=\"create-startup\">\r\n        <div class=\"create-startup__form\">\r\n          <v-input\r\n            :label=\"'Заголовок'\"\r\n            :error=\"$v.form.title.$error\"\r\n            v-model=\"$v.form.title.$model\"\r\n            :text-error=\"'введите заголовок'\"\r\n            require-input\r\n          />\r\n          <v-multiselect\r\n            :label=\"'Категория'\"\r\n            :options=\"CATEGORY\"\r\n            :value=\"form.categories\"\r\n            @multi-change=\"form.categories = $event\"\r\n          ></v-multiselect>\r\n\r\n          <div\r\n            class=\"form-control\"\r\n            :class=\"{ 'form-control--error': $v.form.body.$error }\"\r\n          >\r\n            <vue-editor\r\n              v-model=\"$v.form.body.$model\"\r\n              :editorToolbar=\"customToolbar\"\r\n            ></vue-editor>\r\n            <label v-show=\"!$v.form.body.$error\">\r\n              Описание\r\n              <span class=\"form-control__require\">*</span>\r\n            </label>\r\n            <label v-show=\"$v.form.body.$error\">введите описание</label>\r\n          </div>\r\n\r\n          <file-pond\r\n            name=\"test\"\r\n            ref=\"pond\"\r\n            label-idle=\"Добавить фото\"\r\n            :allow-multiple=\"true\"\r\n            accepted-file-types=\"image/jpeg, image/png\"\r\n            imagePreviewHeight=\"100\"\r\n            :allow-reorder=\"true\"\r\n            :max-files=\"1\"\r\n            @updatefiles=\"handleFilePond\"\r\n            @reorderfiles=\"handleFilePond\"\r\n          />\r\n\r\n          <div class=\"create-startup__form-group-btn\">\r\n            <button class=\"button-primary\" @click=\"updateStartup\">\r\n              Отправить на проверку\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"UpdateStartup\"\r\n};\r\n</script>\r\n\r\n<script>\r\nimport { required } from \"vuelidate/lib/validators\";\r\nimport qs from \"qs\";\r\nimport vueFilePond from \"vue-filepond\";\r\nimport \"filepond/dist/filepond.min.css\";\r\nimport \"filepond-plugin-image-preview/dist/filepond-plugin-image-preview.min.css\";\r\nimport FilePondPluginFileValidateType from \"filepond-plugin-file-validate-type\";\r\nimport FilePondPluginImagePreview from \"filepond-plugin-image-preview\";\r\nimport axios from \"axios\";\r\nimport { VueEditor } from \"vue2-editor\";\r\nimport VMultiselect from \"../components/vMultiselect\";\r\nimport VInput from \"../components/vInput\";\r\nimport { mapActions, mapGetters } from \"vuex\";\r\n\r\n// Create component\r\nconst FilePond = vueFilePond(\r\n  FilePondPluginFileValidateType,\r\n  FilePondPluginImagePreview\r\n);\r\n\r\nexport default {\r\n  name: \"UpdateStartup\",\r\n  components: {\r\n    VInput,\r\n    VMultiselect,\r\n    VueEditor,\r\n    FilePond\r\n  },\r\n  data() {\r\n    return {\r\n      load: false,\r\n      form: {\r\n        title: \"\",\r\n        body: \"\",\r\n        categories: [],\r\n        title_picture: {},\r\n        images: []\r\n      },\r\n      title_picture: null,\r\n      category: [],\r\n      customToolbar: [\r\n        [\"bold\", \"italic\", \"underline\"],\r\n        [{ list: \"ordered\" }, { list: \"bullet\" }]\r\n      ]\r\n    };\r\n  },\r\n  validations: {\r\n    form: {\r\n      title: {\r\n        required\r\n      },\r\n      body: {\r\n        required\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.GET_CATEGORY();\r\n    this.viewStartup();\r\n  },\r\n  methods: {\r\n    ...mapActions(\"category\", [\"GET_CATEGORY\"]),\r\n    handleFilePond: function() {\r\n      let fileImages = this.$refs.pond.getFiles();\r\n      this.title_picture = fileImages.map(item => item.file)[0];\r\n    },\r\n    async uploadTitleImage() {\r\n      let formDataTitleImage = new FormData();\r\n      formDataTitleImage.append(\"file\", this.title_picture);\r\n\r\n      await axios\r\n        .post(\r\n          `${process.env.VUE_APP_API_URL}/v1/event/upload-title`,\r\n          formDataTitleImage,\r\n          {\r\n            headers: {\r\n              \"Content-Type\": \"multipart/form-data\"\r\n            }\r\n          }\r\n        )\r\n        .then(result => {\r\n          this.form.title_picture = result.data[0];\r\n        })\r\n        .catch(error => {\r\n          console.log(error);\r\n        });\r\n    },\r\n    async viewStartup() {\r\n      let load = this.$loading.show();\r\n\r\n      let url = new URL(`${process.env.VUE_APP_API_URL}/v1/startup/view`);\r\n      url.searchParams.set(\"id\", this.$route.params.id);\r\n\r\n      await axios\r\n        .get(url)\r\n        .then(response => {\r\n          this.form.title = response.data.title;\r\n          this.form.body = response.data.body;\r\n          this.form.categories = response.data.categories;\r\n          this.load = true;\r\n          load.hide();\r\n        })\r\n        .catch(error => {\r\n          if (error.response.status === 404) {\r\n            this.$toasted.global.error(\"Стартап не найден\");\r\n            this.$router.push(\"/playbill\");\r\n          } else {\r\n            this.$toasted.global.error(error.response.data.message);\r\n          }\r\n          if (!error.response) {\r\n            this.$toasted.global.error(\"Нет соединения с сервером\");\r\n            load.hide();\r\n          }\r\n          load.hide();\r\n        });\r\n    },\r\n    async updateStartup() {\r\n      this.$v.$touch();\r\n      if (!this.$v.$invalid) {\r\n        if (this.title_picture) {\r\n          await this.uploadTitleImage();\r\n        }\r\n\r\n        let form = qs.stringify({\r\n          title: this.form.title,\r\n          body: this.form.body,\r\n          category_ids: this.form.categories.map(item => item.id),\r\n          title_picture: this.form.title_picture\r\n        });\r\n\r\n        let url = new URL(`${process.env.VUE_APP_API_URL}/v1/startup/update`);\r\n        url.searchParams.set(\"id\", this.$route.params.id);\r\n\r\n        await axios\r\n          .patch(url, form)\r\n          .then(response => {\r\n            this.$toasted.global.success(\r\n              \"Стартап обновлен и отправлен на проверку\"\r\n            );\r\n            this.form.title = response.data.title;\r\n            this.form.body = response.data.body;\r\n            this.form.categories = response.data.categories;\r\n            this.form.title_picture = {};\r\n            this.form.images = [];\r\n            this.$refs.pond.removeFiles();\r\n            this.$v.$reset();\r\n            this.$router.push(\"/art-startups\");\r\n          })\r\n          .catch(error => {\r\n            error.data.forEach(item => {\r\n              this.$toasted.global.error(item.message);\r\n            });\r\n          });\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters(\"category\", [\"CATEGORY\"])\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped></style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpdateStartup.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpdateStartup.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UpdateStartup.vue?vue&type=template&id=5b7ff774&scoped=true&\"\nimport script from \"./UpdateStartup.vue?vue&type=script&lang=js&\"\nexport * from \"./UpdateStartup.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5b7ff774\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}