(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0abe48"],{"16e2":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"page"},[r("div",{staticClass:"page__content"},[e._m(0),r("div",{staticClass:"create-event"},[r("div",{staticClass:"create-event__form"},[r("v-input",{attrs:{label:"Заголовок",error:e.$v.form.title.$error,"text-error":"введите заголовок","require-input":""},model:{value:e.$v.form.title.$model,callback:function(t){e.$set(e.$v.form.title,"$model",t)},expression:"$v.form.title.$model"}}),r("v-select",{attrs:{label:"Стартап",options:e.STARTUP,value:e.form.startup,"show-error":e.$v.form.startup.$error,"error-text":"укажите стартап","require-input":""},on:{"select-change":function(t){e.form.startup=t}}}),r("v-select",{attrs:{label:"Площадка проведения",options:e.PLACE,value:e.form.place,"error-text":"укажите необходимую площадку проведения"},on:{"select-change":function(t){e.form.place=t}}}),r("v-multiselect",{attrs:{label:"Категория",options:e.CATEGORY,value:e.form.categories},on:{"multi-change":function(t){e.form.categories=t}}}),r("v-multiselect",{attrs:{label:"Пригласить резидентов","label-field":"full_name",options:e.members,value:e.form.members},on:{"multi-change":function(t){e.form.members=t}}}),r("div",{staticClass:"form-control"},[r("date-picker",{attrs:{format:"DD MMM YYYY HH:mm",type:"datetime","value-type":"timestamp","disabled-date":e.notBeforeToday,editable:!1},model:{value:e.form.begin_time,callback:function(t){e.$set(e.form,"begin_time",t)},expression:"form.begin_time"}},[r("i",{attrs:{slot:"icon-calendar"},slot:"icon-calendar"})]),r("label",[e._v("Время начала события")])],1),r("div",{staticClass:"form-control",class:{"form-control--error":e.$v.form.body.$error}},[r("vue-editor",{attrs:{editorToolbar:e.customToolbar},model:{value:e.$v.form.body.$model,callback:function(t){e.$set(e.$v.form.body,"$model",t)},expression:"$v.form.body.$model"}}),r("label",{directives:[{name:"show",rawName:"v-show",value:!e.$v.form.body.$error,expression:"!$v.form.body.$error"}]},[e._v("\n            Описание события\n            "),r("span",{staticClass:"form-control__require"},[e._v("*")])]),r("label",{directives:[{name:"show",rawName:"v-show",value:e.$v.form.body.$error,expression:"$v.form.body.$error"}]},[e._v("введите описание события")])],1),r("file-pond",{ref:"pond",attrs:{name:"test","label-idle":"Добавить фото","allow-multiple":!0,"accepted-file-types":"image/jpeg, image/png",imagePreviewHeight:"100","allow-reorder":!0,"max-files":10},on:{updatefiles:e.handleFilePond,reorderfiles:e.handleFilePond}}),r("div",{staticClass:"create-event__form-group-btn"},[r("button",{staticClass:"button-primary",on:{click:e.createEvent}},[e._v("\n            Отправить на проверку\n          ")])])],1)])])])},i=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"page__header"},[r("h1",{staticClass:"page__title"},[e._v("\n        Новое событие\n      ")])])}],o=(r("8e6e"),r("456d"),r("ac6a"),r("96cf"),r("1da1")),n=r("ade3"),s=r("b5ae"),c=r("4328"),l=r.n(c),u=r("1501"),m=r.n(u),f=(r("4ed3"),r("57c8"),r("1942")),p=r.n(f),d=r("2cfc"),b=r.n(d),v=r("bc3a"),h=r.n(v),g=r("5873"),_=r("88d3"),y=r("f581"),$=r("2f62"),w=r("9ed6"),O=r("ec45");r("107a");function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){Object(n["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var j=m()(p.a,b.a),C={name:"CreateEvent",components:{VSelect:w["a"],VInput:y["a"],VMultiselect:_["a"],VueEditor:g["a"],FilePond:j,DatePicker:O["default"]},data:function(){return{form:{title:"",body:"",categories:[],place:{},startup:{},members:[],title_picture:{},images:[],begin_time:""},members:[],title_picture:null,images:null,category:[],customToolbar:[["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}]]}},validations:{form:{title:{required:s["required"]},body:{required:s["required"]},startup:{required:s["required"]}}},mounted:function(){var e=this;this.GET_CATEGORY(),this.GET_PLACE(),this.GET_STARTUP(),this.RESIDENTS_LIST().then((function(t){e.members=t.data._items}))},methods:E(E(E(E(E({},Object($["b"])("category",["GET_CATEGORY"])),Object($["b"])("place",["GET_PLACE"])),Object($["b"])("startup",["GET_STARTUP"])),Object($["b"])("user",["RESIDENTS_LIST"])),{},{handleFilePond:function(){var e=this.$refs.pond.getFiles();this.title_picture=e.map((function(e){return e.file}))[0],this.images=e.map((function(e){return e.file})).slice(1)},uploadImages:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=new FormData,this.images.forEach((function(e){t.append("file[]",e)})),e.next=4,h.a.post("".concat("http://api.art-kvadrat.localhost","/v1/event/upload-images"),t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){r.form.images=e.data.files})).catch((function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),uploadTitleImage:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=new FormData,t.append("file",this.title_picture),e.next=4,h.a.post("".concat("http://api.art-kvadrat.localhost","/v1/event/upload-title"),t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){r.form.title_picture=e.data[0]})).catch((function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),createEvent:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.$v.$touch(),this.$v.$invalid){e.next=11;break}if(!this.title_picture){e.next=5;break}return e.next=5,this.uploadTitleImage();case 5:if(!Array.isArray(this.images)||!this.images.length){e.next=8;break}return e.next=8,this.uploadImages();case 8:return t=l.a.stringify({title:this.form.title,body:this.form.body,place_id:this.form.place.id,category_ids:this.form.categories.map((function(e){return e.id})),members_ids:this.form.members.map((function(e){return e.id})),startup_id:this.form.startup.id,begin_time:this.form.begin_time/1e3,title_picture:this.form.title_picture,images:this.form.images}),e.next=11,h.a.post("".concat("http://api.art-kvadrat.localhost","/v1/event/create"),t).then((function(){r.$toasted.global.success("Событие создано и отправлено на проверку"),r.form={title:"",body:"",categories:[],place:{},startup:{},title_picture:{},images:[],begin_time:""},r.$refs.pond.removeFiles(),r.$v.$reset(),r.$router.push("/playbill")})).catch((function(e){e.data.forEach((function(e){r.$toasted.global.error(e.message)}))}));case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),notBeforeToday:function(e){return e<new Date((new Date).setHours(0,0,0,0))}}),computed:E(E(E({},Object($["c"])("category",["CATEGORY"])),Object($["c"])("place",["PLACE"])),Object($["c"])("startup",["STARTUP"]))},P=C,x=r("2877"),k=Object(x["a"])(P,a,i,!1,null,"c5d3bb54",null);t["default"]=k.exports}}]);
//# sourceMappingURL=chunk-2d0abe48.9d846c0d.js.map